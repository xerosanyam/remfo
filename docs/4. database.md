# Database

## how to connect to DB?

there are multiple ways, starting from base layer: (in context of supabase)

1. Direct Connection - has been removed in favor of connection pooling
2. Connection Pooling - uses supavisor (connection string, username, password)

   1. Transaction mode - for serverless; PORT - 6543
   2. Session mode - for long-lived connection; PORT - 5432

   in terms of how to connect to db, only change b/w 2 modes is PORT
   dependency - need to use a driver (like postgres.js)
   can't connect directly from frontend (can be both pro & con)

3. Data APIs - REST endpoints, generated by postgREST
   dependency - postgresREST extension

4. Use library like Supabase-js - wrapped over REST end points - but its syntax is like ORM
   dependency - postgresREST

5. ORMS (drizzle, prisma) - they connect using connection pooling
   dependency - db driver

## Data APIs

### con:

- dependency over postgREST
- postgREST requries setting up additional server (more work, more attack surface?)
- can't move to neon/tembo/RDS because they don't have postgREST out of the box

### pros:

- can be called via fetch. simple.
- can be called directly by form.
- no need to write sql scripts for simple CRUD
- less business logic
- makes use of RLS

## Connection Pooling

### con

- can't use RLS. no good support yet. (drizzle, prisma are trying to find ways)
